Лабораторная работа 4
1. В этой лабораторной работы нужно создать четыре сценария на языке командного
интерпретатора.:
стартовый (подготовительный) задает рабочую среду;
первый (основной) выполняет задание;
второй (тестовый) проверяет правильность работы основного;
третий (обнуляющий) возвращает систему в исходное состояние так,
чтобы можно было запустить процесс выполнения сценариев сначала.
2. Задача стартового сценария четвертой лабораторной работы:
запустить в фоновом режиме 5 процессов;
3 из которых являются целевыми, а 2 — дополнительными.
Для примеров фоновых процессов можно выбрать ping ya.ru и ping yandex.ru.
3. Основной сценарий должен прекратить выполнение только целевых процессов.
4. Тестовый сценарий должен сообщать сколько целевых и дополнительных процессов
выполняется в данный момент.
5. Для возврата к начальным условиям необходимо прекратить выполнение всех
запущенных процессов.
6. В этой лабораторной работе первым разработайте тестовый сценарий. Запустите
текстовый редактор:
nano test4.sh
7. Наберите шебанг и первые комментарии с описанием сценария:
#!/bin/sh
# сценарий мониторинга запущенных процессов
# лабораторная работа № 4
echo "ping по адресу ya.ru"
#количество основных процессов
pgrep -f ya.ru| wc -l
echo "ping по адресу yandex.ru"
# количество доп. процессов
pgrep -f yandex.ru| wc -l
8. Сохраните файл и закройте редактор. Настройте права на исполнение и запустите
сценарий. При первом запуске в результате должны получиться нули.
9. Разработайте стартовый сценарий, :
nano start4.sh
#!/bin/sh
# сценарий запуска фоновых процессов
# лабораторная работа № 4
# запускаем 3 целевых процесса
for i in `seq 1 3`; do ping ya.ru >/dev/null & done
# запускаем 2 дополнительных процесса
for i in 1 2; do ping yandex.ru >/dev/null & done
10. Сохраните файл и закройте редактор. Настройте права на исполнение и запустите
сценарий.
11. После этого снова запустите test4.sh, проверьте количество целевых и
дополнительных процессов.
12. Основной сценарий должен «убить» процессы, связанные с ya.ru, и «пощадить» все
остальные:
nano base4.sh
#!/bin/sh
# сценарий целевого прекращения процессов
# лабораторная работа № 4
# выбираем и прекращаем процессы
for p in `pgrep -f ya.ru`
do
kill $p
done
13. Сохраните файл и закройте редактор. Настройте права на исполнение и запустите
сценарий. После чего запустите test4.sh и проверьте количество целевых и
дополнительных процессов.
14. Очищающий сценарий прекращает все процессы, запущенные в ходе работы:
nano reset4.sh
#!/bin/sh
# сценарий очистки для
# лабораторная работа № 4
# прекращаем все процессы из Лаб.работы 4
for p in `pgrep -f ya.ru`
do
kill
$p
done
for p in `pgrep -f yandex.ru`
do
kill
$p
done
15. Сохраните файл и закройте редактор. Настройте права на исполнение и запустите
сценарий. После чего запустите test4.sh и проверьте количество целевых и
дополнительных процессов.
Задание 4.2
В качестве самостоятельного задания разработайте аналогичные сценарии, изменив их так,
чтобы адреса сайтов (целевого и дополнительного) задавались как параметры при запуске
сценария. Должна проводиться проверка количества передаваемых параметров.
